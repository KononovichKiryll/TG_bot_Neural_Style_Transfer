Telegram Style Transfer bot
==============
---
Это учебный проект бота с функцией переноса стиля изображений по алгориту Neural Style Transfer  
  
***Содержание:***
- [Описание проекта](#Description)
- [Установка проекта](#Setup)
     - [Установка зависимостей](#dependencies)
     - [Создание образа Docker](#docker)
     - [Необходимые токены](#Tokens)
- [Работа с ботом](#Bot)
     - [Команды](#Commands)
     - [Примеры](#Samples)
 

# Описание проекта <a name="Description"></a>

**Telegram Style Transfer bot** — Это учебный проект бота с функцией переноса стиля по алгориту Neural Style Transfer(NST). Задачай проекта являлось написание работающего телеграмм бота который может принимать изображения и обрабатывать их. Обработка осуществлялась с использованием ML алгоритма NST описанного по этой ссылке: https://pytorch.org/tutorials/advanced/neural_style_tutorial.html. 
  
# Установка проекта <a name="Setup"></a>

В проекте использовались фреймворки Аiogram для написания бота и PyTorch для работы ML-модели. Версия Python 3.10.

## Установка зависимостей <a name="dependencies"></a>

Необходимые зависимости описаны в файле `requarements.txt`.  
Для работы использовались версии PyTorch: `torch-2.0.0+cpu-cp310-cp310-win_amd64.whl`, и `torchvision-0.15.1+cpu-cp310-cp310-win_amd64.whl` доступные на официальном сайте PyTorch по ссылке: https://download.pytorch.org/whl/cpu/torch_stable.html. Возможно использование других версий PyTorch не ниже версии 2.0.0 и CUDA, доступных здесь: https://pytorch.org/get-started/locally/

## Создание образа Docker и запуск бота<a name="docker"></a>

Для создания и развёртывания образа необходимо:
1. В файле Dockerfile указать токена бота `TG_BOT_TOKEN` в переменную окружения `ENV`:  
     `ENV TG_BOT_TOKEN 1234567`  
2. Создать образ выполнив команду в терминале:
     `docker build -t bot .`
3. После создания образа запустить контейнер:
     `docker run --name NST_bot -d bot`
4. Бот работает! Первый запуск бота будет может занять некоторое время, PyTorch будет скачивать модели.

## Необходимые токены <a name="Tokens"></a>
  
Для работы бота необходимо в корне репозитория создать файл с переменными окружения `.env` с указанием токена бота в переменной `TG_BOT_TOKEN`.
Так же в файле `config.config` в переменную `ADMINS_ID` можно указать ID администраторов бота для отслеживания запуска работы бота (опцтонально). 

  
# Работа с ботом <a name="Bot"></a>

## Команды <a name="Commands"></a>

Все доступные боту комманды указаны в всплывающей клавиатуре. На иные комманды бот будет выдавать сообщение об ошибке.  
Список команд:
- `/start` - запуск бота
- `/help` - помощь
- `Перенос стиля` - переход в меню переноса стиля
     - `Загрузить картинку контента` - загрузка картинки контента
     - `Загрузить картинку стиля` - загрузка картинки контента
     - `Назад` - возврат к предыдущему меню/отмена действия
     - `Далее` - возврат к предыдущему меню/отмена действия
- `Настройки` - переход в меню настроек
     - `Установить разрешение` - установка разрешения для выходной картинки
     - `Установить количество итераций` - установка количества итераций алгоритма
     - `Назад` - возврат к предыдущему меню/отмена действия


## Примеры <a name="Samples"></a>

Примеры работы бота:
Переходим в меню создания картики, загружаем картинку которую хоти изменить и картинку стиля. Запустим процесс переноса стиля. Для картинок маленького разрешения процесс происходит достаточно быстро:   
![gif_1.gif](https://github.com/KononovichKiryll/TG_bot_Neural_Style_Transfer/blob/main/gif_screnshots/gif_1.gif)  
Процесс переноса стиля происходит асинхронно, поэтому бот реагирует на команды но для экономии ресурсов они заблокированы.  
  
  
Перед запуском бота можно настроить разрешение картинки и количество итераций:  
![gif_2.gif](https://github.com/KononovichKiryll/TG_bot_Neural_Style_Transfer/blob/main/gif_screnshots/gif_2.gif)
  
Результат:  
![attachment:Screenshot_4.png](https://github.com/KononovichKiryll/TG_bot_Neural_Style_Transfer/blob/main/gif_screnshots/Screenshot_4.png)
